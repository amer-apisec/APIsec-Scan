{"openapi":"3.0.1","info":{"title":"Data Provenance API Docs","description":"Sample REST API documentation","version":"alpha0.3"},"servers":[{"url":"https://easypims.pimcity-h2020.eu/provenance"}],"tags":[{"name":"wm","description":"Endpoints for Watermarking verification over datasets"},{"name":"urls","description":"Endpoints for URL operations"},{"name":"ipfs","description":"The IPFS API Endpoints"},{"name":"dataset","description":"Endpoints for CRUD operations on datasets"}],"paths":{"/dp/datasets/query/{queryId}":{"get":{"tags":["dataset"],"summary":"Get a Dataset by queryId","operationId":"getFile","parameters":[{"name":"queryId","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"Found dataset from queryId in IPFS","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Dataset"}}}},"404":{"description":"Dataset queryId not found in IPFS","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorObject"}}}},"400":{"description":"Dataset queryId bad request in IPFS","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorObject"}}}}}}},"/dp/datasets/dataset/{id}":{"get":{"tags":["dataset"],"summary":"Get a Dataset by id","operationId":"getDatasetById","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int32"}}],"responses":{"404":{"description":"Dataset id not found in IPFS","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorObject"}}}},"200":{"description":"Found dataset from id in IPFS","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Dataset"}}}},"400":{"description":"Dataset id bad request in IPFS","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorObject"}}}}}}},"/dp/datasets/user/{userId}":{"get":{"tags":["dataset"],"summary":"Get Dataset for userId","operationId":"getDatasetsByUserId","parameters":[{"name":"userId","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"400":{"description":"Dataset userId bad request in IPFS","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorObject"}}}},"404":{"description":"Dataset for userId not found in IPFS","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorObject"}}}},"200":{"description":"Got datasets for userId","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Dataset"}}}}}}},"/dp/datasets":{"get":{"tags":["dataset"],"summary":"Get All Datasets","description":"Find all datasets","operationId":"getAllDatasets","responses":{"200":{"description":"found datasets","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Dataset"}}}},"404":{"description":"Member not found","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorObject"}}}},"400":{"description":"Bad request","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorObject"}}}}}},"post":{"tags":["dataset"],"summary":"POST a dataset","description":"CSV file to add for watermarking","operationId":"generateDataset","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/Dataset"}}}},"responses":{"404":{"description":"Dataset not saved in IPFS","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorObject"}}}},"200":{"description":"saved dataset in IPFS","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Dataset"}}}},"400":{"description":"Bad request in IPFS","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorObject"}}}}}}},"/ipfs/putByte":{"post":{"tags":["ipfs"],"summary":"Create new IPFS file from bytes","operationId":"putByte","responses":{"200":{"description":"New file in bytes to IPFS created","content":{"application/json":{"schema":{"$ref":"#/components/schemas/JsonString"}}}},"400":{"description":"New file in bytes bad request in IPFS","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorObject"}}}}}}},"/ipfs/dataset/{queryId}":{"get":{"tags":["ipfs"],"summary":"Get a file from IPFS by hash id","operationId":"getOne","parameters":[{"name":"queryId","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"Found the hash id in IPFS","content":{"application/json":{"schema":{"type":"string"}}}},"404":{"description":"Invalid hash id supplied in IPFS","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorObject"}}}},"400":{"description":"Hash id bad request in IPFS","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorObject"}}}}}},"post":{"tags":["ipfs"],"summary":"Send queryId as IPFS hash to watermarkig in DP module","operationId":"postQueryId","parameters":[{"name":"queryId","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"QueryId to IPFS success","content":{"application/json":{"schema":{"$ref":"#/components/schemas/JsonString"}}}},"400":{"description":"QueryId bad request in IPFS","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorObject"}}}}}}},"/ipfs/dataset":{"post":{"tags":["ipfs"],"summary":"Create new IPFS file","operationId":"putOne","requestBody":{"content":{"multipart/form-data":{"schema":{"type":"object","properties":{"file":{"type":"string","format":"binary"}}}}}},"responses":{"200":{"description":"Put file to IPFS success","content":{"application/json":{"schema":{"$ref":"#/components/schemas/JsonString"}}}},"400":{"description":"File creation bad request in IPFS","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorObject"}}}}}}},"/urls":{"post":{"tags":["urls"],"summary":"Create a new url","operationId":"createUrl","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/Url"}}}},"responses":{"200":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/Url"}}}}}}},"/urls/{id}":{"get":{"tags":["urls"],"summary":"Get a single url","operationId":"getUrlById","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"400":{"description":"Invalid request"},"200":{"description":"Found the url id","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Url"}}}}}}},"/urls/sample":{"get":{"tags":["urls"],"summary":"Get 10 urls","operationId":"getSample","responses":{"200":{"description":"default response","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Url"}}}}}}}},"/urls/user/{userId}":{"get":{"tags":["urls"],"summary":"Get urls for a user id","operationId":"getUrlByUserId","parameters":[{"name":"userId","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"Found the user urls","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Url"}}}},"400":{"description":"Invalid request"}}}},"/dp/wm/{queryId}":{"get":{"tags":["wm"],"summary":"Verify a WM Dataset by ipfs hash","operationId":"getOne_1","parameters":[{"name":"queryId","in":"path","required":true,"schema":{"type":"string"}},{"name":"key","in":"query","required":true,"schema":{"type":"array","items":{"type":"string","format":"byte"}}},{"name":"alpha","in":"query","required":false,"schema":{"type":"integer","format":"int32","default":10}}],"responses":{"404":{"description":"dataset not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorObject"}}}},"200":{"description":"dataset belongs to you","content":{"application/json":{"schema":{"type":"string"}}}},"400":{"description":"dataset does not belong to you","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorObject"}}}},"410":{"description":"File gone or non existing","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorObject"}}}}}}}},"components":{"schemas":{"Dataset":{"required":["queryId"],"type":"object","properties":{"queryId":{"type":"string","description":"Dataset unique identifier id","example":"1"},"user_id":{"type":"integer","description":"The user id column in table url or dataset","format":"int32","example":123456},"buyer_id":{"type":"integer","description":"The buyer id column in table url or dataset","format":"int32","example":12345},"filePath":{"type":"string"},"fileHash":{"type":"string"},"timestamp":{"type":"string","format":"date-time"},"datasetByQueryId":{"type":"string"},"userId":{"type":"integer","format":"int32"}}},"ErrorObject":{"type":"object","properties":{"errorCode":{"type":"string","description":"HTTP status error code","example":"400"},"errorDescription":{"type":"string","description":"Error description and details","example":"Dataset does not exists in DB"}}},"JsonString":{"type":"object","properties":{"body":{"type":"string"}}},"Url":{"type":"object","properties":{"id":{"type":"integer","description":"The primary key","format":"int64","example":1},"timestamp":{"type":"string","description":"The timestamp column in table url","format":"date-time"},"url":{"type":"string","description":"The url column in table url","example":"http://www.ant1iwo.com/"},"buyerid":{"type":"string","description":"The buyer id column in table url","example":"a3w34w3"},"userId":{"type":"string"}}}}}}
