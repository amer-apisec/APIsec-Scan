{"openapi":"3.0.1","info":{"title":"POL-on 2 Users API","description":"Users management module Api","license":{"name":"OPI 2.0","url":"https://opi.org.pl"},"version":"0.80.2"},"externalDocs":{"description":"Dokumentacja API dla POL-on 2.0","url":"https://polon.nauka.gov.pl/pomoc/knowledge-base/dokumentacja-api-dla-pol-on-2-0/"},"servers":[{"url":"https://polon2.opi.org.pl/users-api","description":"Generated server url"}],"security":[{"mcl":[]},{"institution":[]}],"tags":[{"name":"Current User"},{"name":"Permission"},{"name":"User Search"},{"name":"User Account"},{"name":"User Lock"},{"name":"Institution"},{"name":"User Data"}],"paths":{"/v1_1/user/{userId}/permission":{"put":{"tags":["Permission"],"operationId":"setPermissions_V_1_1","parameters":[{"name":"userId","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SetPermissionsToUserRequest"}}},"required":true},"responses":{"200":{"description":"OK"}}}},"/user/{userId}":{"put":{"tags":["User Data"],"operationId":"updateUser","parameters":[{"name":"userId","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateUserRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/RepresentationModelObject"}}}}}}},"/user/{userId}/unlockInInstitution":{"put":{"tags":["User Lock"],"operationId":"unlockUserInInstitution","parameters":[{"name":"userId","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK"}}}},"/user/{userId}/permission":{"put":{"tags":["Permission"],"operationId":"setPermissions","parameters":[{"name":"userId","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SetPermissionsToUserRequest"}}},"required":true},"responses":{"200":{"description":"OK"}}}},"/user/{userId}/lockInInstitution":{"put":{"tags":["User Lock"],"operationId":"lockUserInInstitution","parameters":[{"name":"userId","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK"}}}},"/user/{userId}/link":{"put":{"tags":["User Data"],"operationId":"linkUserWithCurrentInstitution","parameters":[{"name":"userId","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/RepresentationModelObject"}}}}}}},"/user/{userIdString}/globalunlock":{"put":{"tags":["User Lock"],"operationId":"globalUnlockUser","parameters":[{"name":"userIdString","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK"}}}},"/user/{userIdString}/globallock":{"put":{"tags":["User Lock"],"operationId":"globalLockUser","parameters":[{"name":"userIdString","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK"}}}},"/user":{"post":{"tags":["User Data"],"operationId":"registerUser","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RegisterUserRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/RegisterUserResponse"}}}}}}},"/users/{userIdString}/smallDetails":{"get":{"tags":["User Search"],"operationId":"find","parameters":[{"name":"userIdString","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UserSmallDetailsResponse"}}}}}}},"/users/{userIdString}/smallDetailsByMinistry":{"get":{"tags":["User Search"],"operationId":"find_1","parameters":[{"name":"userIdString","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UserSmallDetailsResponse"}}}}}}},"/users/find":{"get":{"tags":["User Search"],"operationId":"find_2","parameters":[{"name":"name","in":"query","required":false,"schema":{"type":"string","default":""}},{"name":"surname","in":"query","required":false,"schema":{"type":"string","default":""}},{"name":"email","in":"query","required":false,"schema":{"type":"string","default":""}},{"name":"roleCode","in":"query","required":false,"schema":{"type":"string","default":""}},{"name":"statusCode","in":"query","required":false,"schema":{"type":"string","default":"ALL"}},{"name":"withActivePermission","in":"query","required":false,"schema":{"type":"boolean","default":false}},{"name":"withoutActivePermission","in":"query","required":false,"schema":{"type":"boolean","default":false}},{"name":"page","in":"query","description":"Zero-based page index (0..N)","schema":{"type":"integer","default":0}},{"name":"size","in":"query","description":"The size of the page to be returned","schema":{"type":"integer","default":20}},{"name":"sort","in":"query","description":"Sorting criteria in the format: property(,asc|desc). Default sort order is ascending. Multiple sort criteria are supported.","schema":{"type":"array","items":{"type":"string"}}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/PagedModelUserDataResource"}}}}}}},"/users/findByMinistry":{"get":{"tags":["User Search"],"operationId":"find_3","parameters":[{"name":"name","in":"query","required":false,"schema":{"type":"string","default":""}},{"name":"surname","in":"query","required":false,"schema":{"type":"string","default":""}},{"name":"email","in":"query","required":false,"schema":{"type":"string","default":""}},{"name":"roleCodes","in":"query","required":false,"schema":{"type":"array","items":{"type":"string"},"default":[]}},{"name":"institutionId","in":"query","required":false,"schema":{"type":"string","default":""}},{"name":"page","in":"query","description":"Zero-based page index (0..N)","schema":{"type":"integer","default":0}},{"name":"size","in":"query","description":"The size of the page to be returned","schema":{"type":"integer","default":20}},{"name":"sort","in":"query","description":"Sorting criteria in the format: property(,asc|desc). Default sort order is ascending. Multiple sort criteria are supported.","schema":{"type":"array","items":{"type":"string"}}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/PagedModelUserDataResource"}}}}}}},"/user/{userId}/requestAccountRegistration":{"get":{"tags":["User Account"],"operationId":"requestAccountRegistration","parameters":[{"name":"userId","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/RepresentationModelObject"}}}}}}},"/user/{userId}/registerAccount":{"get":{"tags":["User Account"],"operationId":"registerAccount","parameters":[{"name":"userId","in":"path","required":true,"schema":{"type":"string"}},{"name":"token","in":"query","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/RepresentationModelObject"}}}}}}},"/user/{userId}/permissions":{"get":{"tags":["Permission"],"operationId":"userPermissions","parameters":[{"name":"userId","in":"path","required":true,"schema":{"type":"string"}},{"name":"institutionId","in":"query","required":false,"schema":{"type":"string","default":""}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/CollectionModelPermissionsInInstitutionResource"}}}}}}},"/user/{userId}/effectivePermissions":{"get":{"tags":["Permission"],"operationId":"effectivePermissions","parameters":[{"name":"userId","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/CollectionModelPermissionsInInstitutionResource"}}}}}}},"/user/{userId}/details":{"get":{"tags":["User Search"],"operationId":"userDetails","parameters":[{"name":"userId","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UserDataDetails"}}}}}}},"/user/{userIdString}/fullname":{"get":{"tags":["User Search"],"operationId":"getUserFullName","parameters":[{"name":"userIdString","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UserFullName"}}}}}}},"/user/{email}/":{"get":{"tags":["User Data"],"operationId":"getUserByEmail","parameters":[{"name":"email","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ExistingUserData"}}}}}}},"/summary/min/filter/roles":{"get":{"tags":["Permission"],"operationId":"getFiterRolesForSupervisedMinSummary","responses":{"200":{"description":"OK","content":{"application/hal+json":{"schema":{"$ref":"#/components/schemas/MinFilterRoles"}}}}}}},"/inst/getById/{institutionId}":{"get":{"tags":["Institution"],"operationId":"findInstitutionById","parameters":[{"name":"institutionId","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/InstitutionDataResource"}}}}}}},"/inst/allInstitutionsBySupervisingOrAdmin":{"get":{"tags":["Institution"],"operationId":"findInstitutionsBySupervisingOrAdmin","parameters":[{"name":"pattern","in":"query","required":false,"schema":{"type":"string","default":""}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/CollectionModelObject"}}}}}}},"/inst/allInstitutionsBySuperAdmin":{"get":{"tags":["Institution"],"operationId":"findInstitutionsBySuperAdmin","parameters":[{"name":"pattern","in":"query","required":false,"schema":{"type":"string","default":""}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/CollectionModelObject"}}}}}}},"/inst/allInstitutionsByMinistry":{"get":{"tags":["Institution"],"operationId":"findInstitutionsBySupervisingMinistry","parameters":[{"name":"pattern","in":"query","required":false,"schema":{"type":"string","default":""}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/CollectionModelObject"}}}}}}},"/currentuser":{"get":{"tags":["Current User"],"operationId":"getCurrentUserData","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/CurrentUserData"}}}}}}},"/currentuser/permissions":{"get":{"tags":["Current User"],"operationId":"getCurrentUserPermissions","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/CurrentUserPermissions"}}}}}}},"/currentuser/basicdata":{"get":{"tags":["Current User"],"operationId":"getCurrentUserBasicData","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/CurrentUserBasicData"}}}}}}},"/auth/institutionsWhereUserHasActiveRoles":{"get":{"tags":["Institution"],"operationId":"getInstitutionsWhereUserHasActiveRoles","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/CollectionModelObject"}}}}}}},"/auth/institution/{institutionId}/roles":{"get":{"tags":["Permission"],"operationId":"rolesForInstitutionType","parameters":[{"name":"institutionId","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"application/hal+json":{"schema":{"$ref":"#/components/schemas/RolesInInstitution"}}}}}}},"/auth/allInstitution":{"get":{"tags":["Institution"],"operationId":"findInstitutionsByName","parameters":[{"name":"name","in":"query","required":false,"schema":{"type":"string","default":""}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/CollectionModelObject"}}}}}}}},"components":{"schemas":{"PermissionRequest":{"type":"object","properties":{"role":{"type":"string"},"expirationDate":{"type":"string","format":"date"},"canMailing":{"type":"boolean"}}},"SetPermissionsToUserRequest":{"type":"object","properties":{"institutionId":{"type":"string"},"permissions":{"type":"array","items":{"$ref":"#/components/schemas/PermissionRequest"}}}},"UpdateUserRequest":{"type":"object","properties":{"name1":{"type":"string"},"name2":{"type":"string"},"surname":{"type":"string"},"email":{"type":"string"},"phoneNumber":{"type":"string"},"userNote":{"type":"string"}}},"Links":{"type":"object","additionalProperties":{"$ref":"#/components/schemas/Link"}},"RepresentationModelObject":{"type":"object","properties":{"_links":{"$ref":"#/components/schemas/Links"}}},"RegisterUserRequest":{"type":"object","properties":{"name1":{"type":"string"},"name2":{"type":"string"},"surname":{"type":"string"},"email":{"type":"string"},"phoneNumber":{"type":"string"},"userNote":{"type":"string"}}},"RegisterUserResponse":{"type":"object","properties":{"userId":{"type":"string"},"_links":{"$ref":"#/components/schemas/Links"}}},"DescriptionInfo":{"type":"object","properties":{"system":{"type":"string"},"module":{"type":"string"},"description":{"type":"string"},"_links":{"$ref":"#/components/schemas/Links"}}},"Institution":{"type":"object","properties":{"id":{"type":"string"},"name":{"type":"string"},"status":{"$ref":"#/components/schemas/InstitutionStatusModel"}}},"InstitutionStatusModel":{"type":"object","properties":{"code":{"type":"string","enum":["OPERATING","IN_LIQUIDATION","LIQUIDATED","TRANSFORMED","RE_REGISTRATION","ERASED"]},"label":{"type":"string"}}},"PermissionSmallDataResponse":{"type":"object","properties":{"institution":{"$ref":"#/components/schemas/Institution"},"roles":{"type":"array","items":{"$ref":"#/components/schemas/Role"}}}},"PersonSmallDataResponse":{"type":"object","properties":{"userId":{"type":"string"},"name1":{"type":"string"},"name2":{"type":"string"},"surname":{"type":"string"},"email":{"type":"string"},"active":{"type":"boolean"}}},"Role":{"type":"object","properties":{"name":{"type":"string"},"infos":{"type":"array","items":{"$ref":"#/components/schemas/DescriptionInfo"}}}},"UserSmallDetailsResponse":{"type":"object","properties":{"data":{"$ref":"#/components/schemas/PersonSmallDataResponse"},"permissions":{"type":"array","items":{"$ref":"#/components/schemas/PermissionSmallDataResponse"}},"_links":{"$ref":"#/components/schemas/Links"}}},"PageMetadata":{"type":"object","properties":{"size":{"type":"integer","format":"int64"},"totalElements":{"type":"integer","format":"int64"},"totalPages":{"type":"integer","format":"int64"},"number":{"type":"integer","format":"int64"}}},"PagedModelUserDataResource":{"type":"object","properties":{"_embedded":{"type":"object","properties":{"userDataResources":{"type":"array","items":{"$ref":"#/components/schemas/UserDataResource"}}}},"_links":{"$ref":"#/components/schemas/Links"},"page":{"$ref":"#/components/schemas/PageMetadata"}}},"UserDataResource":{"type":"object","properties":{"userId":{"type":"string"},"name":{"type":"string"},"secondName":{"type":"string"},"surname":{"type":"string"},"email":{"type":"string"},"active":{"type":"boolean"},"_links":{"$ref":"#/components/schemas/Links"}}},"CollectionModelPermissionsInInstitutionResource":{"type":"object","properties":{"_embedded":{"type":"object","properties":{"permissionsInInstitutionResources":{"type":"array","items":{"$ref":"#/components/schemas/PermissionsInInstitutionResource"}}}},"_links":{"$ref":"#/components/schemas/Links"}}},"PermissionResource":{"type":"object","properties":{"role":{"type":"string"},"expireDate":{"type":"string","format":"date"},"_links":{"$ref":"#/components/schemas/Links"}}},"PermissionsInInstitutionResource":{"type":"object","properties":{"institutionId":{"type":"string"},"permissions":{"type":"array","items":{"$ref":"#/components/schemas/PermissionResource"}},"_links":{"$ref":"#/components/schemas/Links"}}},"Permission":{"type":"object","properties":{"role":{"$ref":"#/components/schemas/Role"},"expireDate":{"type":"string","format":"date"},"canManage":{"type":"boolean"},"canMailing":{"type":"boolean"}}},"PermissionsInstitutions":{"type":"object","properties":{"institution":{"$ref":"#/components/schemas/Institution"},"permissions":{"type":"array","items":{"$ref":"#/components/schemas/Permission"}}}},"PersonalData":{"type":"object","properties":{"userId":{"type":"string"},"username":{"type":"string"},"name1":{"type":"string"},"name2":{"type":"string"},"surname":{"type":"string"},"email":{"type":"string"},"phoneNumber":{"type":"string"},"globalLock":{"type":"boolean"},"institutionLock":{"type":"array","items":{"$ref":"#/components/schemas/Institution"}},"userNote":{"type":"string"}}},"Profile":{"type":"object","properties":{"profileId":{"type":"string"},"profileName":{"type":"string"},"institution":{"$ref":"#/components/schemas/Institution"},"expireDate":{"type":"string","format":"date"},"roles":{"type":"array","items":{"$ref":"#/components/schemas/Role"}}}},"UserDataDetails":{"type":"object","properties":{"data":{"$ref":"#/components/schemas/PersonalData"},"permissions":{"type":"array","items":{"$ref":"#/components/schemas/PermissionsInstitutions"}},"profiles":{"type":"array","items":{"$ref":"#/components/schemas/Profile"}},"_links":{"$ref":"#/components/schemas/Links"}}},"UserFullName":{"type":"object","properties":{"userFullName":{"type":"string"},"_links":{"$ref":"#/components/schemas/Links"}}},"ExistingUserData":{"type":"object","properties":{"existingUserId":{"type":"string"},"userFullName":{"type":"string"},"email":{"type":"string"},"_links":{"$ref":"#/components/schemas/Links"}}},"MinFilterRoles":{"type":"object","properties":{"filterRoles":{"type":"array","items":{"type":"string"}},"_links":{"$ref":"#/components/schemas/Links"}}},"InstitutionDataResource":{"type":"object","properties":{"institutionId":{"type":"string"},"name":{"type":"string"},"_links":{"$ref":"#/components/schemas/Links"}}},"CollectionModelObject":{"type":"object","properties":{"_embedded":{"type":"object","properties":{"objects":{"type":"array","items":{"type":"object"}}}},"_links":{"$ref":"#/components/schemas/Links"}}},"CurrentUserData":{"type":"object","properties":{"userId":{"type":"string"},"name1":{"type":"string"},"name2":{"type":"string"},"surname":{"type":"string"},"mainInstitutionId":{"type":"string"},"userRolesInInstitution":{"type":"array","items":{"type":"string"}},"effectiveRoles":{"type":"array","items":{"$ref":"#/components/schemas/EffectivePermission"}},"_links":{"$ref":"#/components/schemas/Links"}}},"EffectivePermission":{"type":"object","properties":{"role":{"type":"string"},"institutionId":{"type":"string"}}},"CurrentUserPermissions":{"type":"object","properties":{"userId":{"type":"string"},"permissions":{"type":"array","items":{"$ref":"#/components/schemas/UserPermissions"}},"_links":{"$ref":"#/components/schemas/Links"}}},"PermissionResponse":{"type":"object","properties":{"role":{"$ref":"#/components/schemas/Role"},"expireDate":{"type":"string","format":"date"},"canMailing":{"type":"boolean"}}},"UserPermissions":{"type":"object","properties":{"permissions":{"type":"array","items":{"$ref":"#/components/schemas/PermissionResponse"}},"institution":{"$ref":"#/components/schemas/Institution"}}},"BasicData":{"type":"object","properties":{"userId":{"type":"string"},"name1":{"type":"string"},"name2":{"type":"string"},"surname":{"type":"string"},"username":{"type":"string"},"email":{"type":"string"},"phoneNumber":{"type":"string"},"institutionLock":{"type":"array","items":{"$ref":"#/components/schemas/Institution"}},"userNote":{"type":"string"},"globalLocked":{"type":"boolean"}}},"CurrentUserBasicData":{"type":"object","properties":{"data":{"$ref":"#/components/schemas/BasicData"},"_links":{"$ref":"#/components/schemas/Links"}}},"RolesInInstitution":{"type":"object","properties":{"roles":{"type":"array","items":{"$ref":"#/components/schemas/Role"}},"_links":{"$ref":"#/components/schemas/Links"}}},"Link":{"type":"object","properties":{"href":{"type":"string"},"hreflang":{"type":"string"},"title":{"type":"string"},"type":{"type":"string"},"deprecation":{"type":"string"},"profile":{"type":"string"},"name":{"type":"string"},"templated":{"type":"boolean"}}}},"securitySchemes":{"mcl":{"type":"oauth2","flows":{"authorizationCode":{"authorizationUrl":"https://mcl.opi.org.pl/auth/realms/OPI/protocol/openid-connect/auth","tokenUrl":"https://mcl.opi.org.pl/auth/realms/OPI/protocol/openid-connect/token"}}},"institution":{"type":"apiKey","name":"institution","in":"header"}}}}
